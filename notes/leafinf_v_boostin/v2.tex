\documentclass[12pt]{article}
\usepackage{amsmath}
\usepackage{amssymb}


\begin{document}

\subsection*{TracIn}

Single Step:
\begin{align*}
\ell(w_{t+1}, z') &= \ell(w_t, z') + \nabla \ell(w_t, z') \cdot (w_{t+1} - w_t) + O(||w_{t+1} - w_t||^2) \\
\ell(w_t, z')  - \ell(w_{t+1}, z') &\approx -\nabla \ell(w_t, z') \cdot (w_{t+1} - w_t) \\
\ell(w_t, z')  - \ell(w_{t+1}, z') &\approx \eta_t \nabla \ell(w_t, z') \cdot \nabla \ell(w_t, z) \because w_{t+1} - w_t = -\eta_t \nabla \ell(w_t, z)
\end{align*}
\\
All Steps:
\begin{align*}
\text{TracIn}(z, z') = \sum_t \eta_t \nabla \ell(w_t, z') \cdot \nabla (w_t, z)
\end{align*}

\subsection*{BoostIn}
\begin{align*}
\text{BoostIn}(z, z') &= \sum_t I[P(z')_t = P(z)_t] \left(- \frac{\partial L(y', f_t(z'))}{\partial f_t(z')} \cdot (\alpha_{P(z')_t}^{t} - \alpha_{P(z')_t}^t[\setminus z]) \right) \\
&= \boxed{\sum_t I[P(z')_t = P(z)_t] \left(\eta_t \frac{\partial L(y', f_t(z'))}{\partial f_t(z')} \cdot \frac{\partial \alpha_{P(z')_t}^t}{\partial z} \right)}, \\
\frac{\partial \alpha_{P(z')_t}^t}{\partial z} &= \frac{g_z^t + h_z^t\alpha_{P(z')_t}^t}{\beta_l^t}
\end{align*}

\subsection*{LeafInfluence (Single Point)}
\begin{align*}
\text{LeafInf}(z, z') &= \boxed{-\left(\frac{\partial L(y', f_T(z'))}{\partial f_T(z')}\right) \left(\sum_t I[P(z')_t = P(z)_t] \cdot \frac{\partial \alpha_{P(z')_t}^t}{\partial z} \right)} \\
\frac{\partial \alpha_{P(z')_t}^t}{\partial z} &= \frac{(g_z^t + h_z^t\alpha_{P(z')_t}^t) + (h_z^t + k_z^t \alpha_{P(z')_t}^t)J_z^{t-1}}{\beta_l^t} \\
J_z^t &= J_z^{t-1} + \frac{\partial \alpha_{P(z)_t}^t}{\partial z}
\end{align*}

\subsection*{Notation}
\begin{align*}
z, z' &= \text{Train and test examples, respectively.} \\
P(z)_t &= \text{Leaf that $z$ ends at for tree $t$.} \\
\alpha_l^t &= \text{Leaf value for leaf $l$ at tree $t$.} \\
\beta_l^t &= \text{Sum of 2nd derivatives for leaf $l$ in tree $t$.} \\
g_z^t, h_z^t, k_z^t &= \text{ 1st, 2nd, and 3rd derivatives for example $z$ in tree $t$, respectively.} \\
J_z^t &= \text{Prediction derivative accumulator; cum. sum for example $z$ at tree $t$.} \\
\end{align*}

\end{document}
